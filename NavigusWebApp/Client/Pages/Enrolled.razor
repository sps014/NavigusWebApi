@page "/enrolled"

@using NavigusWebApp.Client.Data
@using System.Net.Http.Headers
@using NavigusWebApi.Models

@inject HttpClient Http
@inject NavigationManager Nav
<NavMenu></NavMenu>

@if (courses is not null)
{
    <div class="container">
        <div class="row">
            @foreach (var c in courses.EnrolledCourses)
            {
                <div class="card text-white bg-dark m-3" style="max-width: 18rem;">
                    <div class="card-header m-2">@c.CourseId</div>
                    <div class="card-body m-2">
                        <h5 class="card-title">Enrolled on @c.EnrolledTimeStamp.ToDateTime().ToString()</h5>
                        @if (!c.QuizStarted)
                        {
                            <div class="btn btn-primary m-2">Begin Quiz</div>
                        }
                        else
                        {
                            <p>Marks: @c.PointsObtained</p>
                            <p>XP: @c.XpObtained</p>
                        }
                    </div>
                </div>

            }
        </div>

    </div>
}


@code 
{
    StudentModel courses;
    protected override async Task OnInitializedAsync()
    {
        courses = await FetchAll();
        StateHasChanged();
    }

    async Task<StudentModel> FetchAll()
    {

        Http.DefaultRequestHeaders.Authorization = CredsData.HeaderJWT;
        try
        {
            return await Http.GetFromJsonAsync<StudentModel>("/Student/enrolledlist");
        }
        catch (Exception _)
        {
            return null;
        }
    }
    

    

}

<style>
    head,body
    {
    background-color: #A9C9FF;
    background-image: linear-gradient(180deg, #A9C9FF 0%, #FFBBEC 100%);
    height: 100vh;
    }
</style>